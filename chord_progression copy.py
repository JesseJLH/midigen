from flask import Flask, render_template, request, send_file
from midiutil import MIDIFile

chord_midi_values = {
    'C': [60, 64, 67],
    'C#': [61, 65, 68],
    'Db': [61, 65, 68],
    'D': [62, 66, 69],
    'D#': [63, 67, 70],
    'Eb': [63, 67, 70],
    'E': [64, 68, 71],
    'F': [65, 69, 72],
    'F#': [66, 70, 73],
    'Gb': [66, 70, 73],
    'G': [67, 71, 74],
    'G#': [68, 72, 75],
    'Ab': [68, 72, 75],
    'A': [69, 73, 76],
    'A#': [70, 74, 77],
    'Bb': [70, 74, 77],
    'B': [71, 75, 78],
    'Cm': [60, 63, 67],
    'C#m': [61, 64, 68],
    'Dbm': [61, 64, 68],
    'Dm': [62, 65, 69],
    'D#m': [63, 66, 70],
    'Ebm': [63, 66, 70],
    'Em': [64, 67, 71],
    'Fm': [65, 68, 72],
    'F#m': [66, 69, 73],
    'Gbm': [66, 69, 73],
    'Gm': [67, 70, 74],
    'G#m': [68, 71, 75],
    'Abm': [68, 71, 75],
    'Am': [69, 72, 76],
    'A#m': [70, 73, 77],
    'Bbm': [70, 73, 77],
    'Bm': [71, 74, 78],
    'C7': [60, 64, 67, 70],
    'C#7': [61, 65, 68, 71],
    'Db7': [61, 65, 68, 71],
    'D7': [62, 66, 69, 72],
    'D#7': [63, 67, 70, 73],
    'Eb7': [63, 67, 70, 73],
    'E7': [64, 68, 71, 74],
    'F7': [65, 69, 72, 75],
    'F#7': [66, 70, 73, 76],
    'Gb7': [66, 70, 73, 76],
    'G7': [67, 71, 74, 77],
    'G#7': [68, 72, 75, 78],
    'Ab7': [68, 72, 75, 78],
    'A7': [69, 73, 76, 79],
    'A#7': [70, 74, 77, 80],
    'Bb7': [70, 74, 77, 80],
    'B7': [71, 75, 78, 81],
    'Cm7': [60, 63, 67, 70],
    'C#m7': [61, 64, 68, 71],
    'Dbm7': [61, 64, 68, 71],
    'Dm7': [62, 65, 69, 72],
    'D#m7': [63, 66, 70, 73],
    'Ebm7': [63, 66, 70, 73],
    'Em7': [64, 67, 71, 74],
    'Fm7': [65, 68, 72, 75],
    'F#m7': [66, 69, 73, 76],
    'Gbm7': [66, 69, 73, 76],
    'Gm7': [67, 70, 74, 77],
    'G#m7': [68, 71, 75, 78],
    'Abm7': [68, 71, 75, 78],
    'Am7': [69, 72, 76, 79],
    'A#m7': [70, 73, 77, 80],
    'Bbm7': [70, 73, 77, 80],
    'Bm7': [71, 74, 78, 81],
    'Cmaj7': [60, 64, 67, 71],
    'C#maj7': [61, 65, 68, 72],
    'Dbmaj7': [61, 65, 68, 72],
    'Dmaj7': [62, 66, 69, 73],
    'D#maj7': [63, 67, 70, 74],
    'Ebmaj7': [63, 67, 70, 74],
    'Emaj7': [64, 68, 71, 75],
    'Fmaj7': [65, 69, 72, 76],
    'F#maj7': [66, 70, 73, 77],
    'Gbmaj7': [66, 70, 73, 77],
    'Gmaj7': [67, 71, 74, 78],
    'G#maj7': [68, 72, 75, 79],
    'Abmaj7': [68, 72, 75, 79],
    'Amaj7': [69, 73, 76, 80],
    'A#maj7': [70, 74, 77, 81],
    'Bbmaj7': [70, 74, 77, 81],
    'Bmaj7': [71, 75, 78, 82],
    'C9': [60, 64, 67, 70, 74],
    'C#9': [61, 65, 68, 71, 75],
    'Db9': [61, 65, 68, 71, 75],
    'D9': [62, 66, 69, 72, 76],
    'D#9': [63, 67, 70, 73, 77],
    'Eb9': [63, 67, 70, 73, 77],
    'E9': [64, 68, 71, 74, 78],
    'F9': [65, 69, 72, 75, 79],
    'F#9': [66, 70, 73, 76, 80],
    'Gb9': [66, 70, 73, 76, 80],
    'G9': [67, 71, 74, 77, 81],
    'G#9': [68, 72, 75, 78, 82],
    'Ab9': [68, 72, 75, 78, 82],
    'A9': [69, 73, 76, 79, 83],
    'A#9': [70, 74, 77, 80, 84],
    'Bb9': [70, 74, 77, 80, 84],
    'B9': [71, 75, 78, 81, 85],
    'Cmin9': [60, 63, 67, 70, 74],
    'C#min9': [61, 64, 68, 71, 75],
    'Dbmin9': [61, 64, 68, 71, 75],
    'Dmin9': [62, 65, 69, 72, 76],
    'D#min9': [63, 66, 70, 73, 77],
    'Ebmin9': [63, 66, 70, 73, 77],
    'Emin9': [64, 67, 71, 74, 78],
    'Fmin9': [65, 68, 72, 75, 79],
    'F#min9': [66, 69, 73, 76, 80],
    'Gbmin9': [66, 69, 73, 76, 80],
    'Gmin9': [67, 70, 74, 77, 81],
    'G#min9': [68, 71, 75, 78, 82],
    'Abmin9': [68, 71, 75, 78, 82],
    'Amin9': [69, 72, 76, 79, 83],
    'A#min9': [70, 73, 77, 80, 84],
    'Bbmin9': [70, 73, 77, 80, 84],
    'Bmin9': [71, 74, 78, 81, 85],
    'Cmaj9': [60, 64, 67, 71, 74],
    'C#maj9': [61, 65, 68, 72, 75],
    'Dbmaj9': [61, 65, 68, 72, 75],
    'Dmaj9': [62, 66, 69, 73, 76],
    'D#maj9': [63, 67, 70, 74, 77],
    'Ebmaj9': [63, 67, 70, 74, 77],
    'Emaj9': [64, 68, 71, 75, 78],
    'Fmaj9': [65, 69, 72, 76, 79],
    'F#maj9': [66, 70, 73, 77, 80],
    'Gbmaj9': [66, 70, 73, 77, 80],
    'Gmaj9': [67, 71, 74, 78, 81],
    'G#maj9': [68, 72, 75, 79, 82],
    'Abmaj9': [68, 72, 75, 79, 82],
    'Amaj9': [69, 73, 76, 80, 83],
    'A#maj9': [70, 74, 77, 81, 84],
    'Bbmaj9': [70, 74, 77, 81, 84],
    'Bmaj9': [71, 75, 78, 82, 85],
    'C11': [60, 64, 67, 70, 72, 74],
    'C#11': [61, 65, 68, 71, 73, 75],
    'Db11': [61, 65, 68, 71, 73, 75],
    'D11': [62, 66, 69, 72, 74, 76],
    'D#11': [63, 67, 70, 73, 75, 77],
    'Eb11': [63, 67, 70, 73, 75, 77],
    'E11': [64, 68, 71, 74, 76, 78],
    'F11': [65, 69, 72, 75, 77, 79],
    'F#11': [66, 70, 73, 76, 78, 80],
    'Gb11': [66, 70, 73, 76, 78, 80],
    'G11': [67, 71, 74, 77, 79, 81],
    'G#11': [68, 72, 75, 78, 80, 82],
    'Ab11': [68, 72, 75, 78, 80, 82],
    'A11': [69, 73, 76, 79, 81, 83],
    'A#11': [70, 74, 77, 80, 82, 84],
    'Bb11': [70, 74, 77, 80, 82, 84],
    'B11': [71, 75, 78, 81, 83, 85],
    'Cmin11': [60, 63, 67, 70, 72, 75],
    'C#min11': [61, 64, 68, 71, 73, 76],
    'Dbmin11': [61, 64, 68, 71, 73, 76],
    'Dmin11': [62, 65, 69, 72, 74, 77],
    'D#min11': [63, 66, 70, 73, 75, 78],
    'Ebmin11': [63, 66, 70, 73, 75, 78],
    'Emin11': [64, 67, 71, 74, 76, 79],
    'Fmin11': [65, 68, 72, 75, 77, 80],
    'F#min11': [66, 69, 73, 76, 78, 81],
    'Gbmin11': [66, 69, 73, 76, 78, 81],
    'Gmin11': [67, 70, 74, 77, 79, 82],
    'G#min11': [68, 71, 75, 78, 80, 83],
    'Abmin11': [68, 71, 75, 78, 80, 83],
    'Amin11': [69, 72, 76, 79, 81, 84],
    'A#min11': [70, 73, 77, 80, 82, 85],
    'Bbmin11': [70, 73, 77, 80, 82, 85],
    'Bmin11': [71, 74, 78, 81, 83, 86],
    'Cmaj11': [60, 64, 67, 71, 74, 77],
    'C#maj11': [61, 65, 68, 72, 75, 78],
    'Dbmaj11': [61, 65, 68, 72, 75, 78],
    'Dmaj11': [62, 66, 69, 73, 76, 79],
    'D#maj11': [63, 67, 70, 74, 77, 80],
    'Ebmaj11': [63, 67, 70, 74, 77, 80],
    'Emaj11': [64, 68, 71, 75, 78, 81],
    'Fmaj11': [65, 69, 72, 76, 79, 82],
    'F#maj11': [66, 70, 73, 77, 80, 83],
    'Gbmaj11': [66, 70, 73, 77, 80, 83],
    'Gmaj11': [67, 71, 74, 78, 81, 84],
    'G#maj11': [68, 72, 75, 79, 82, 85],
    'Abmaj11': [68, 72, 75, 79, 82, 85],
    'Amaj11': [69, 73, 76, 80, 83, 86],
    'A#maj11': [70, 74, 77, 81, 84, 87],
    'Bbmaj11': [70, 74, 77, 81, 84, 87],
    'Bmaj11': [71, 75, 78, 82, 85, 88],
    'C13': [60, 64, 67, 70, 74, 77, 81],
    'C#13': [61, 65, 68, 71, 75, 78, 82],
    'Db13': [61, 65, 68, 71, 75, 78, 82],
    'D13': [62, 66, 69, 72, 76, 79, 83],
    'D#13': [63, 67, 70, 73, 77, 80, 84],
    'Eb13': [63, 67, 70, 73, 77, 80, 84],
    'E13': [64, 68, 71, 74, 78, 81, 85],
    'F13': [65, 69, 72, 75, 79, 82, 86],
    'F#13': [66, 70, 73, 76, 80, 83, 87],
    'Gb13': [66, 70, 73, 76, 80, 83, 87],
    'G13': [67, 71, 74, 77, 81, 84, 88],
    'G#13': [68, 72, 75, 78, 82, 85, 89],
    'Ab13': [68, 72, 75, 78, 82, 85, 89],
    'A13': [69, 73, 76, 79, 83, 86, 90],
    'A#13': [70, 74, 77, 80, 84, 87, 91],
    'Bb13': [70, 74, 77, 80, 84, 87, 91],
    'B13': [71, 75, 78, 81, 85, 88, 92],
    'Cmin13': [60, 63, 67, 70, 74, 77, 81],
    'C#min13': [61, 64, 68, 71, 75, 78, 82],
    'Dbmin13': [61, 64, 68, 71, 75, 78, 82],
    'Dmin13': [62, 65, 69, 72, 76, 79, 83],
    'D#min13': [63, 66, 70, 73, 77, 80, 84],
    'Ebmin13': [63, 66, 70, 73, 77, 80, 84],
    'Emin13': [64, 67, 71, 74, 78, 81, 85],
    'Fmin13': [65, 68, 72, 75, 79, 82, 86],
    'F#min13': [66, 69, 73, 76, 80, 83, 87],
    'Gbmin13': [66, 69, 73, 76, 80, 83, 87],
    'Gmin13': [67, 70, 74, 77, 81, 84, 88],
    'G#min13': [68, 71, 75, 78, 82, 85, 89],
    'Abmin13': [68, 71, 75, 78, 82, 85, 89],
    'Amin13': [69, 72, 76, 79, 83, 86, 90],
    'A#min13': [70, 73, 77, 80, 84, 87, 91],
    'Bbmin13': [70, 73, 77, 80, 84, 87, 91],
    'Bmin13': [71, 74, 78, 81, 85, 88, 92],
    'Cmaj13': [60, 64, 67, 71, 74, 78, 81],
    'C#maj13': [61, 65, 68, 72, 75, 79, 82],
    'Dbmaj13': [61, 65, 68, 72, 75, 79, 82],
    'Dmaj13': [62, 66, 69, 73, 76, 80, 83],
    'D#maj13': [63, 67, 70, 74, 77, 81, 84],
    'Ebmaj13': [63, 67, 70, 74, 77, 81, 84],
    'Emaj13': [64, 68, 71, 75, 78, 82, 85],
    'Fmaj13': [65, 69, 72, 76, 79, 83, 86],
    'F#maj13': [66, 70, 73, 77, 80, 84, 87],
    'Gbmaj13': [66, 70, 73, 77, 80, 84, 87],
    'Gmaj13': [67, 71, 74, 78, 81, 85, 88],
    'G#maj13': [68, 72, 75, 79, 82, 86, 89],
    'Abmaj13': [68, 72, 75, 79, 82, 86, 89],
    'Amaj13': [69, 73, 76, 80, 83, 87, 90],
    'A#maj13': [70, 74, 77, 81, 84, 88, 91],
    'Bbmaj13': [70, 74, 77, 81, 84, 88, 91],
    'Bmaj13': [71, 75, 78, 82, 85, 89, 92],
    'Csus4': [60, 63, 67, 70],
    'C#sus4': [61, 64, 68, 71],
    'Dbsus4': [61, 64, 68, 71],
    'Dsus4': [62, 65, 69, 72],
    'D#sus4': [63, 66, 70, 73],
    'Ebsus4': [63, 66, 70, 73],
    'Esus4': [64, 67, 71, 74],
    'Fsus4': [65, 68, 72, 75],
    'F#sus4': [66, 69, 73, 76],
    'Gbsus4': [66, 69, 73, 76],
    'Gsus4': [67, 70, 74, 77],
    'G#sus4': [68, 71, 75, 78],
    'Absus4': [68, 71, 75, 78],
    'Asus4': [69, 72, 76, 79],
    'A#sus4': [70, 73, 77, 80],
    'Bbsus4': [70, 73, 77, 80],
    'Bsus4': [71, 74, 78, 81],
    'Csus2': [60, 64, 67, 72],
    'C#sus2': [61, 65, 68, 73],
    'Dbsus2': [61, 65, 68, 73],
    'Dsus2': [62, 66, 69, 74],
    'D#sus2': [63, 67, 70, 75],
    'Ebsus2': [63, 67, 70, 75],
    'Esus2': [64, 68, 71, 76],
    'Fsus2': [65, 69, 72, 77],
    'F#sus2': [66, 70, 73, 78],
    'Gbsus2': [66, 70, 73, 78],
    'Gsus2': [67, 71, 74, 79],
    'G#sus2': [68, 72, 75, 80],
    'Absus2': [68, 72, 75, 80],
    'Asus2': [69, 73, 76, 81],
    'A#sus2': [70, 74, 77, 82],
    'Bbsus2': [70, 74, 77, 82],
    'Bsus2': [71, 75, 78, 83],
    'Cmsus4': [60, 63, 66, 70],
    'Dmsus4': [62, 65, 68, 72],
    'Emsus4': [64, 67, 70, 74],
    'Fmsus4': [65, 68, 71, 75],
    'Gmsus4': [67, 70, 73, 77],
    'Amsus4': [69, 72, 75, 79],
    'Bmsus4': [71, 74, 77, 81],
    'Cmsus2': [60, 63, 67, 72],
    'Dmsus2': [62, 65, 69, 74],
    'Emsus2': [64, 67, 71, 76],
    'Fmsus2': [65, 68, 72, 77],
    'Gmsus2': [67, 70, 74, 79],
    'Amsus2': [69, 72, 76, 81],
    'Bmsus2': [71, 74, 78, 83],
    'C9sus4': [48, 55, 60, 63, 70],
    'C#9sus4': [49, 56, 61, 64, 71],
    'D9sus4': [50, 57, 62, 65, 72],
    'D#9sus4': [51, 58, 63, 66, 73],
    'E9sus4': [52, 59, 64, 67, 74],
    'F9sus4': [53, 60, 65, 68, 75],
    'F#9sus4': [54, 61, 66, 69, 76],
    'G9sus4': [55, 62, 67, 70, 77],
    'G#9sus4': [56, 63, 68, 71, 78],
    'A9sus4': [57, 64, 69, 72, 79],
    'A#9sus4': [58, 65, 70, 73, 80],
    'B9sus4': [59, 66, 71, 74, 81],
    'C9sus2': [48, 50, 55, 60, 64, 67],
    'C#9sus2': [49, 51, 56, 61, 65, 68],
    'D9sus2': [50, 52, 57, 62, 66, 69],
    'D#9sus2': [51, 53, 58, 63, 67, 70],
    'E9sus2': [52, 54, 59, 64, 68, 71],
    'F9sus2': [53, 55, 60, 65, 69, 72],
    'F#9sus2': [54, 56, 61, 66, 70, 73],
    'G9sus2': [55, 57, 62, 67, 71, 74],
    'G#9sus2': [56, 58, 63, 68, 72, 75],
    'A9sus2': [57, 59, 64, 69, 73, 76],
    'A#9sus2': [58, 60, 65, 70, 74, 77],
    'B9sus2': [59, 61, 66, 71, 75, 78],
    "Cm9sus4": [60, 63, 67, 70, 73],
    "C#m9sus4": [61, 64, 68, 71, 74],
    "Dm9sus4": [62, 65, 69, 72, 75],
    "D#m9sus4": [63, 66, 70, 73, 76],
    "Em9sus4": [64, 67, 71, 74, 77],
    "Fm9sus4": [65, 68, 72, 75, 78],
    "F#m9sus4": [66, 69, 73, 76, 79],
    "Gm9sus4": [67, 70, 74, 77, 80],
    "G#m9sus4": [68, 71, 75, 78, 81],
    "Am9sus4": [69, 72, 76, 79, 82],
    "A#m9sus4": [70, 73, 77, 80, 83],
    "Bm9sus4": [71, 74, 78, 81, 84],
    "Cm9sus2": [60, 63, 66, 70, 73],
    "C#m9sus2": [61, 64, 67, 71, 74],
    "Dm9sus2": [62, 65, 68, 72, 75],
    "D#m9sus2": [63, 66, 69, 73, 76],
    "Em9sus2": [64, 67, 70, 74, 77],
    "Fm9sus2": [65, 68, 71, 75, 78],
    "F#m9sus2": [66, 69, 72, 76, 79],
    "Gm9sus2": [67, 70, 73, 77, 80],
    "G#m9sus2": [68, 71, 74, 78, 81],
    "Am9sus2": [69, 72, 75, 79, 82],
    "A#m9sus2": [70, 73, 76, 80, 83],
    "Bm9sus2": [71, 74, 77, 81, 84],
    "D7sus4": [50, 57, 62, 67],
    "Dmin7sus4": [50, 56, 62, 67],
    "D7sus2": [50, 57, 62, 69],
    "Dmin7sus2": [50, 56, 62, 69],
    "E7sus4": [52, 59, 64, 69],
    "Emin7sus4": [52, 58, 64, 69],
    "E7sus2": [52, 59, 64, 71],
    "Emin7sus2": [52, 58, 64, 71],
    "F7sus4": [53, 60, 65, 70],
    "Fmin7sus4": [53, 59, 65, 70],
    "F7sus2": [53, 60, 65, 72],
    "Fmin7sus2": [53, 59, 65, 72],
    "G7sus4": [55, 62, 67, 72],
    "Gmin7sus4": [55, 61, 67, 72],
    "G7sus2": [55, 62, 67, 74],
    "Gmin7sus2": [55, 61, 67, 74],
    "A7sus4": [57, 64, 69, 74],
    "Amin7sus4": [57, 63, 69, 74],
    "A7sus2": [57, 64, 69, 76],
    "Amin7sus2": [57, 63, 69, 76],
    "B7sus4": [59, 66, 71, 76],
    "Bmin7sus4": [59, 65, 71, 76],
    "B7sus2": [59, 66, 71, 78],
    "Bmin7sus2": [59, 65, 71, 78]
}


selected_keys_str = input("Enter the selected keys separated by commas (e.g. 'C,D'): ")

# Split the user input into a list of selected keys
selected_keys = selected_keys_str.split(',')

# Remove any leading or trailing whitespace from the selected keys
selected_keys = [key.strip() for key in selected_keys]

# Create a new dictionary with only the selected keys
#selected_chord_midi_values = {key: value for key, value in chord_midi_values.items() if key in selected_keys}

midi_file = MIDIFile(numTracks=1, adjust_origin=True)
track = 0
time = 0

# Add a track name
midi_file.addTrackName(track, time, "Chords")

# Initialize note time to 0
note_time = 0

# Iterate over the selected keys and add each chord
for key in selected_keys:
    # Add a note for each pitch in the chord
    for pitch in chord_midi_values[key]:
        midi_file.addNote(track, 0, pitch, note_time, 1, volume=100)
    # Increment note time by some value (e.g. 100) after building the chord
    note_time += 1

# Write the MIDI file to disk
with open("chords.mid", "wb") as output_file:
    midi_file.writeFile(output_file)